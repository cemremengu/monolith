version: "3"

tasks:
  go:
    desc: "Run Go tests"
    cmds:
      - go test -v ./...

  web:
    desc: "Run web tests"
    dir: web
    cmds:
      - npm test

  coverage:go:
    desc: "Run Go tests with coverage"
    cmds:
      - go test -v -coverprofile=coverage.out ./...
      - go tool cover -html=coverage.out -o coverage.html

  coverage:web:
    desc: "Run web tests with coverage"
    dir: web
    cmds:
      - npm run test:coverage

  all:
    desc: "Run all tests"
    cmds:
      - task: go
      - task: web

  coverage:
    desc: "Run all tests with coverage"
    cmds:
      - task: coverage:go
      - task: coverage:web
